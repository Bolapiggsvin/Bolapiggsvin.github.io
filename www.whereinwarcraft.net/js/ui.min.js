const UI_ANIM_SPEED=400;class UI{constructor(){this._isMapEnabled=!1,this._init()}_init(){this.$gameIntro=$("#intro"),this.$gameBanners=$(".game-banner"),this.$gameFrame=$("#game-frame"),this.$gameContent=$("#game-content"),this.$gameImage=$("#game-image"),this.$gameMap=$("#game-map"),this.$gameCanvas=$("#game-drag-inner"),this.$gameOver=$("#game-over"),this.$gameOverSpirit=$("#game-over-spirit"),this.$gameOverTitle=this.$gameOver.children("h2"),this.$gameOverRounds=$("#game-over-rounds").children("span"),this.$gameOverAccuracy=$("#game-over-accuracy").children("span"),this.$scoreRounds=$("#game-score-round").children(".value"),this.$scoreAccuracy=$("#game-score-accuracy").children(".value"),this.$scoreLives=$("#game-score-lives").children(".value"),this.$infoZone=$("#game-map-info"),this.$buttonViewMap=$("#game-button-map"),this.$buttonViewLocation=$("#game-button-location"),this.$buttonSubmitGuess=$("#game-button-confirm"),this.$buttonNextRound=$("#game-button-next"),this.$buttonReplay=$("#game-button-replay"),this.$buttonPlay=$("#btn-play"),this.$buttonPlayClassic=$("#btn-play-classic"),$(".smooth").each(function(){$(this).loadBackgroundSmooth()})}_initializeMap(a){this.map=L.map("game-map",{attributionControl:!1,crs:L.CRS.Simple}),this.resetMapZoom(),this.isClassic=a;const e=a?"tiles_classic":"tiles";L.tileLayer("images/"+e+"/{z}/{x}/{y}.png",{maxZoom:a?6:7}).addTo(this.map),this.map.on("click",a=>this._onMapClick(a))}_onMapClick(a){const e=JSON.stringify(a.latlng);console.log(e),this._isMapEnabled&&(this.mapMarker&&this.mapMarker.remove(),this.mapMarker=L.marker([a.latlng.lat,a.latlng.lng]).addTo(this.map),this.$buttonSubmitGuess.enable())}resetMapZoom(){this.map.setView([-120.90349875311426,124.75],2)}panMap(a){this.map.panTo([a.lat,a.lng],{duration:1,easeLinearity:.1})}showMapPath(a,e,t){this.mapPath&&this.mapPath.remove(),this.mapPath=L.polyline([[a.lat,a.lng],[e.lat,e.lng]],{color:t||"red"}).addTo(this.map)}showMapCircle(a,e,t){this.mapCircle&&this.mapCircle.remove(),this.mapCircle=L.circle([a.lat,a.lng],{color:e,fillColor:e,fillOpacity:.5,radius:t}).addTo(this.map)}clearMap(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null),this.mapPath&&(this.mapPath.remove(),this.mapPath=null),this.mapCircle&&(this.mapCircle.remove(),this.mapCircle=null),this.$infoZone.hide()}enableMap(){this._isMapEnabled=!0}disableMap(){this._isMapEnabled=!1}showMap(){this.$buttonViewLocation.enable(),this.mapMarker&&this.$buttonSubmitGuess.enable(),this.$gameMap.css({"z-index":4,opacity:1}),this.$gameImage.css({opacity:0})}hideMap(){this.$buttonViewMap.enable(),this.$gameMap.css({"z-index":1,opacity:0}),this.$gameImage.css({opacity:1})}setMapInfo(a,e){this.$infoZone.text(a+" - "+e).fadeIn()}enterGame(a,e){this.$gameIntro.fadeOut(UI_ANIM_SPEED,()=>{this.$gameFrame.show(),this.$gameBanners.addClass("extended"),this.$gameContent.fadeInFlex(UI_ANIM_SPEED),this._initializeMap(a),e()})}setGameGlowBorder(a){this.$gameContent.css("box-shadow","inset "+a+" 0 0 80px")}showGameOver(a,e){this.setGameGlowBorder("white"),this.$gameMap.fadeOut(UI_ANIM_SPEED),this.$gameImage.fadeOut(UI_ANIM_SPEED,()=>{a?this.$gameOverTitle.text("You completed every location."):this.$gameOverTitle.text("You ran out of lives."),this.$gameOverRounds.text(e),this.$gameOverAccuracy.text(this.$scoreAccuracy.text()),this.$buttonReplay.enable(),this.$gameOverSpirit.css("display","block").loadBackgroundSmooth(),this.$gameOver.fadeInFlex()})}}